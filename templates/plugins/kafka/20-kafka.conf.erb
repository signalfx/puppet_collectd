# generated by puppet
<Plugin java>
    <Plugin "GenericJMX">

        <MBean "kafka-all-messages">
            ObjectName "kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec"
            InstancePrefix "all"
            <Value>
                InstancePrefix "kafka-messages-in"
                Type "counter"
                Table false
                Attribute "Count"
              </Value>
        </MBean>

        <MBean "kafka-all-bytes-in">
            ObjectName "kafka.server:type=BrokerTopicMetrics,name=BytesInPerSec"
            InstancePrefix "all"
            <Value>
                InstancePrefix "kafka-bytes-in"
                Type "counter"
                Table false
                Attribute "Count"
              </Value>
        </MBean>

        <MBean "kafka-all-bytes-out">
            ObjectName "kafka.server:type=BrokerTopicMetrics,name=BytesOutPerSec"
            InstancePrefix "all"
            <Value>
                InstancePrefix "kafka-bytes-out"
                Type "counter"
                Table false
                Attribute "Count"
            </Value>
        </MBean>

        <MBean "kafka-log-flush">
            ObjectName "kafka.log:type=LogFlushStats,name=LogFlushRateAndTimeMs"
            <Value>
                Type "counter"
                Table false
                Attribute "Count"
                InstancePrefix "kafka-log-flushes"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "Mean"
                InstancePrefix "kafka-log-flush-time-ms"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "95thPercentile"
                InstancePrefix "kafka-log-flush-time-ms-p95"
            </Value>
        </MBean>

        <MBean "kafka-active-controllers">
            ObjectName "kafka.controller:type=KafkaController,name=ActiveControllerCount"
            <Value>
                Type "gauge"
                Table false
                Attribute "Value"
                InstancePrefix "kafka-active-controllers"
            </Value>
        </MBean>

        <MBean "kafka-underreplicated-partitions">
            ObjectName "kafka.server:type=ReplicaManager,name=UnderReplicatedPartitions"
            <Value>
                Type "gauge"
                Table false
                Attribute "Value"
                InstancePrefix "kafka-underreplicated-partitions"
            </Value>
        </MBean>

        <MBean "kafka-request-queue">
            ObjectName "kafka.network:type=RequestChannel,name=RequestQueueSize"
            <Value>
                Type "gauge"
                Table false
                Attribute "Value"
                InstancePrefix "kafka-request-queue"
            </Value>
        </MBean>

        <MBean "kafka.fetch-consumer.total-time">
            ObjectName "kafka.network:type=RequestMetrics,name=TotalTimeMs,request=FetchConsumer"
            <Value>
                Type "counter"
                Table false
                Attribute "Count"
                InstancePrefix "kafka.fetch-consumer.total-time.count"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "50thPercentile"
                InstancePrefix "kafka.fetch-consumer.total-time.median"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "99thPercentile"
                InstancePrefix "kafka.fetch-consumer.total-time.99th"
            </Value>
        </MBean>

        <MBean "kafka.fetch-follower.total-time">
            ObjectName "kafka.network:type=RequestMetrics,name=TotalTimeMs,request=FetchFollower"
            <Value>
                Type "counter"
                Table false
                Attribute "Count"
                InstancePrefix "kafka.fetch-follower.total-time.count"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "50thPercentile"
                InstancePrefix "kafka.fetch-follower.total-time.median"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "99thPercentile"
                InstancePrefix "kafka.fetch-follower.total-time.99th"
            </Value>
        </MBean>

        <MBean "kafka.produce.total-time">
            ObjectName "kafka.network:type=RequestMetrics,name=TotalTimeMs,request=Produce"
            <Value>
                Type "counter"
                Table false
                Attribute "Count"
                InstancePrefix "kafka.produce.total-time.count"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "50thPercentile"
                InstancePrefix "kafka.produce.total-time.median"
            </Value>
            <Value>
                Type "gauge"
                Table false
                Attribute "99thPercentile"
                InstancePrefix "kafka.fetchproducetotal-time.99th"
            </Value>
        </MBean>

	<%- @modules.each do |module_instance, module_config| -%>
	<Connection "<%= module_instance %>">
	<%- module_config.sort_by { |k| k }.each do |key,value| -%>
	  <%- if key == 'collect_metrics' -%>

	  <%- value.each do |collectname| -%>
	  Collect "<%= collectname %>"
	  <%- end -%>
	  <%- else -%>
	  <%= key %> <%= value %>
	  <%- end -%>
	<%- end -%>
	</Connection>
	<%- end -%>

    </Plugin>
</Plugin>
